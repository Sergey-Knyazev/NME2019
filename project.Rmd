---
title: "projectRMD.Rmd"
output: html_document
---

```{r setup, include=FALSE}
# DK = no
my_net<-function(duration, stat, n) {
nw <- network.initialize(n, directed = FALSE)
coef.diss <- dissolution_coefs(~offset(edges), duration)
formation <- ~edges + degree(0:2) + degrange(from = 4)
netest(nw, formation, stat, coef.diss)
}

my_dx<-function(net, param, nsim, nsteps) {
netdx(net, nsims = nsim, nsteps = nsteps,
      nwstats.formula = ~edges + degree(0:4))
}
my_sim<-function(dx, param, numInf, nsteps) {
init <- init.net(i.num = numInf)
control <- control.net(type = "SIS", nsims = 1, nsteps = nsteps)
netsim(dx, param, init, control)
}
```

```{r}
net_par1 = c(45.5, 35, 45, 14, 0)
duration1 = 22
n1 = 100
net1<-my_net(duration1, net_par1, n1)
dx1<-my_dx(net1, net_par1, 5, 200)
dis_par1<-param.net(inf.prob = 0.4, act.rate = 2, rec.rate = 0.01)
sim1<-my_sim(net1, dis_par1, 5, 500)
```

```{r}
```

```{r}

nw <- get_network(sim1$sim)

nw <- color_tea(nw, verbose = FALSE)

slice.par <- list(start = 1, end = 100, interval = 1,
                  aggregate.dur = 1, rule = "any")
render.par <- list(tween.frames = 10, show.time = FALSE)
plot.par <- list(mar = c(0, 0, 0, 0))

compute.animation(nw, slice.par = slice.par, verbose = TRUE)

render.d3movie(
  nw,
  render.par = render.par,
  plot.par = plot.par,
  vertex.col = "ndtvcol",
  edge.col = "darkgrey",
  vertex.border = "lightgrey",
  displaylabels = FALSE,
  filename = paste0(getwd(), "/movie.html"))
```


